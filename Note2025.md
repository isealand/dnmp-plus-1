# 安装准备

```composer log
brew uninstall docker docker-compose

brew update
brew upgrade
brew install docker docker-compose

docker -v
docker-compose -v


brew install colima

colima version

colima start --cpu 3 --memory 6 --disk 10

docker run -d -p 9900:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock --name prtainer_202501_001 portainer/portainer-ce
```

## 错误解决
1、docker-compose err:
error getting credentials - err: exec: "docker-credential-desktop": executable file not found in $PATH, out: ``

fixed:
简单来说，删除文件 "~/.docker/config.json" 中json的以下key/value
```text
"credsStore" : "desktop",
```

```composer log
#path ~/
cd
vim ~/.docker/config.json
```

2、myqsl 5.7 image

Mac M1芯片的机器，拉mysql 5.7的image报错
```composer log
➜  dnmp2025 git:(v2025_01_001) ✗ docker pull mysql:5.7.42
5.7.42: Pulling from library/mysql
no matching manifest for linux/arm64/v8 in the manifest list entries
```

参考：https://github.com/abiosoft/colima/issues/83
https://medium.com/dandelion-tutorials/how-to-fix-chown-permission-denied-issue-when-using-colima-on-mac-os-x-d925e420c875
对本例无效（也可能有效），


fixde:
```
docker-compose.yml 文件内对应添加：

platform: linux/amd64

#服务将以特权模式运行
privileged: true    

```
注：mysql5.7创建ok后，mysql8也成功创建容器，但8的配置没改动。权限问题消失



最终fixed：
在colima最初启动时，须指定配置(mount-type=9p)：
```composer log
colima start --cpu 3 --memory 6 --disk 10 --mount-type 9p
```
如colima启动没指定mount-type，则需执行删除colima实例
```composer log
colima stop

#切记：执行delete会删除当前所有容器与镜像，须注意先存档
colima delete
```
